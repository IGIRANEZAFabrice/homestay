<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Shop | Admin</title>
    <link rel="stylesheet" href="../../css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <?php include 'sidebar.php'; ?>
     <?php include 'header.php'; ?>
    <div class="admin-container">
        <div class="admin-content">
            <div class="content-header">
                <h1>Manage Shop</h1>
                <button class="btn btn-primary" onclick="openAddProductModal()">
                    <i class="fas fa-plus"></i> Add New Product
                </button>
            </div>

            <!-- Hero Section Edit -->
            <div class="card">
                <div class="card-header">
                    <h3>Hero Section</h3>
                </div>
                <div class="form-group">
                    <label for="heroTitle">Hero Title</label>
                    <input type="text" id="heroTitle" class="form-control" value="Traditional Treasures">
                </div>
                <div class="form-group">
                    <label for="heroSubtitle">Hero Subtitle</label>
                    <input type="text" id="heroSubtitle" class="form-control" value="Discover authentic Rwandan crafts and souvenirs">
                </div>
            </div>

            <!-- Categories Management -->
            <div class="card">
                <div class="card-header">
                    <h3>Categories</h3>
                    <button class="btn btn-primary" onclick="openAddCategoryModal()">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>
                <div id="categoriesGrid" class="categories-grid">
                    <!-- Categories will be dynamically added here -->
                </div>
            </div>

            <!-- Products Management -->
            <div class="card">
                <div class="card-header">
                    <h3>Products</h3>
                    <div class="filter-options">
                        <select id="categoryFilter" class="form-control" onchange="filterProducts()">
                            <option value="all">All Categories</option>
                            <option value="handicrafts">Handicrafts</option>
                            <option value="textiles">Textiles</option>
                            <option value="jewelry">Jewelry</option>
                            <option value="art">Art</option>
                        </select>
                    </div>
                </div>
                <div id="productsGrid" class="products-grid">
                    <!-- Products will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Add New Product</h3>
                <button class="close-modal" onclick="closeProductModal()">&times;</button>
            </div>
            <form id="productForm" onsubmit="handleProductSubmit(event)">
                <div class="form-group">
                    <label for="productName">Product Name</label>
                    <input type="text" id="productName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="productCategory">Category</label>
                    <select id="productCategory" class="form-control" required>
                        <option value="handicrafts">Handicrafts</option>
                        <option value="textiles">Textiles</option>
                        <option value="jewelry">Jewelry</option>
                        <option value="art">Art</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productDescription">Description</label>
                    <textarea id="productDescription" class="form-control" required></textarea>
                </div>
                <div class="form-group">
                    <label for="productPrice">Price ($)</label>
                    <input type="number" id="productPrice" class="form-control" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="productOriginalPrice">Original Price ($)</label>
                    <input type="number" id="productOriginalPrice" class="form-control" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label for="productImage">Image URL</label>
                    <input type="text" id="productImage" class="form-control" required>
                    <div class="image-preview" id="productImagePreview"></div>
                </div>
                <div class="form-group">
                    <label for="productBadge">Badge (Optional)</label>
                    <select id="productBadge" class="form-control">
                        <option value="">None</option>
                        <option value="Best Seller">Best Seller</option>
                        <option value="New">New</option>
                        <option value="Sale">Sale</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productRating">Rating (1-5)</label>
                    <input type="number" id="productRating" class="form-control" min="1" max="5" step="0.5" required>
                </div>
                <div class="form-group">
                    <label for="productReviews">Number of Reviews</label>
                    <input type="number" id="productReviews" class="form-control" min="0" required>
                </div>
                <button type="submit" class="btn btn-primary">Save Product</button>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Category</h3>
                <button class="close-modal" onclick="closeCategoryModal()">&times;</button>
            </div>
            <form id="categoryForm" onsubmit="handleCategorySubmit(event)">
                <div class="form-group">
                    <label for="categoryName">Category Name</label>
                    <input type="text" id="categoryName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="categoryImage">Image URL</label>
                    <input type="text" id="categoryImage" class="form-control" required>
                    <div class="image-preview" id="categoryImagePreview"></div>
                </div>
                <button type="submit" class="btn btn-primary">Save Category</button>
            </form>
        </div>
    </div>

    <script>
        // Sample data structure
        let products = [
            {
                id: 1,
                name: "Traditional Basket",
                category: "handicrafts",
                description: "Hand-woven basket made from natural fibers",
                price: 35,
                originalPrice: 45,
                image: "../img/shop/products/basket.jpg",
                badge: "Best Seller",
                rating: 4.5,
                reviews: 24
            },
            // Add more sample products here
        ];

        let categories = [
            {
                id: 1,
                name: "Handicrafts",
                image: "../img/shop/handicrafts.jpg"
            },
            // Add more sample categories here
        ];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderCategories();
            renderProducts();
            setupImagePreviews();
        });

        function setupImagePreviews() {
            const productImageInput = document.getElementById('productImage');
            const productImagePreview = document.getElementById('productImagePreview');
            const categoryImageInput = document.getElementById('categoryImage');
            const categoryImagePreview = document.getElementById('categoryImagePreview');

            productImageInput.addEventListener('input', function() {
                productImagePreview.style.backgroundImage = `url(${this.value})`;
            });

            categoryImageInput.addEventListener('input', function() {
                categoryImagePreview.style.backgroundImage = `url(${this.value})`;
            });
        }

        function renderCategories() {
            const container = document.getElementById('categoriesGrid');
            container.innerHTML = categories.map(category => `
                <div class="category-card">
                    <img src="${category.image}" alt="${category.name}">
                    <h3>${category.name}</h3>
                    <div class="category-actions">
                        <button class="btn btn-primary" onclick="editCategory(${category.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger" onclick="deleteCategory(${category.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderProducts() {
            const container = document.getElementById('productsGrid');
            container.innerHTML = products.map(product => `
                <div class="product-card">
                    <div class="product-image">
                        <img src="${product.image}" alt="${product.name}">
                        ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
                    </div>
                    <div class="product-details">
                        <h3>${product.name}</h3>
                        <p>${product.description}</p>
                        <div class="product-price">
                            <span class="price">$${product.price}</span>
                            ${product.originalPrice ? `<span class="original-price">$${product.originalPrice}</span>` : ''}
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-primary" onclick="editProduct(${product.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteProduct(${product.id})">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openAddProductModal() {
            document.getElementById('modalTitle').textContent = 'Add New Product';
            document.getElementById('productForm').reset();
            document.getElementById('productModal').style.display = 'block';
        }

        function openAddCategoryModal() {
            document.getElementById('categoryForm').reset();
            document.getElementById('categoryModal').style.display = 'block';
        }

        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').style.display = 'none';
        }

        function handleProductSubmit(event) {
            event.preventDefault();
            // Here you would typically send the data to your backend
            const productData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                description: document.getElementById('productDescription').value,
                price: parseFloat(document.getElementById('productPrice').value),
                originalPrice: parseFloat(document.getElementById('productOriginalPrice').value) || null,
                image: document.getElementById('productImage').value,
                badge: document.getElementById('productBadge').value,
                rating: parseFloat(document.getElementById('productRating').value),
                reviews: parseInt(document.getElementById('productReviews').value)
            };

            // For now, just show a success message
            alert('Product saved successfully!');
            closeProductModal();
            // Refresh the products list
            renderProducts();
        }

        function handleCategorySubmit(event) {
            event.preventDefault();
            // Here you would typically send the data to your backend
            const categoryData = {
                name: document.getElementById('categoryName').value,
                image: document.getElementById('categoryImage').value
            };

            // For now, just show a success message
            alert('Category saved successfully!');
            closeCategoryModal();
            // Refresh the categories list
            renderCategories();
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                document.getElementById('modalTitle').textContent = 'Edit Product';
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productDescription').value = product.description;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productOriginalPrice').value = product.originalPrice || '';
                document.getElementById('productImage').value = product.image;
                document.getElementById('productBadge').value = product.badge || '';
                document.getElementById('productRating').value = product.rating;
                document.getElementById('productReviews').value = product.reviews;
                document.getElementById('productModal').style.display = 'block';
            }
        }

        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                // Here you would typically send a delete request to your backend
                products = products.filter(p => p.id !== id);
                renderProducts();
            }
        }

        function editCategory(id) {
            const category = categories.find(c => c.id === id);
            if (category) {
                document.getElementById('categoryName').value = category.name;
                document.getElementById('categoryImage').value = category.image;
                document.getElementById('categoryModal').style.display = 'block';
            }
        }

        function deleteCategory(id) {
            if (confirm('Are you sure you want to delete this category?')) {
                // Here you would typically send a delete request to your backend
                categories = categories.filter(c => c.id !== id);
                renderCategories();
            }
        }

        function filterProducts() {
            const category = document.getElementById('categoryFilter').value;
            const filteredProducts = category === 'all' 
                ? products 
                : products.filter(p => p.category === category);
            
            const container = document.getElementById('productsGrid');
            container.innerHTML = filteredProducts.map(product => `
                <div class="product-card">
                    <div class="product-image">
                        <img src="${product.image}" alt="${product.name}">
                        ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
                    </div>
                    <div class="product-details">
                        <h3>${product.name}</h3>
                        <p>${product.description}</p>
                        <div class="product-price">
                            <span class="price">$${product.price}</span>
                            ${product.originalPrice ? `<span class="original-price">$${product.originalPrice}</span>` : ''}
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-primary" onclick="editProduct(${product.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteProduct(${product.id})">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
